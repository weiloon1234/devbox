#!/usr/bin/env bash
set -euo pipefail

ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
GEN="$ROOT/generated/workspaces"

[[ -d "$GEN" ]] || { echo "(no generated workspaces)"; exit 0; }

shopt -s nullglob
for d in "$GEN"/*; do
  [[ -d "$d" ]] || continue
  ws="$(basename "$d")"
  "$ROOT/scripts/ws-umount" "$ws" || true
done
shopt -u nullglob
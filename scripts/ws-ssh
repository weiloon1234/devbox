#!/usr/bin/env bash
set -euo pipefail

ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"

fail() { echo "ERROR: $*" >&2; exit 1; }

WS_NAME="${1:-}"
[[ -n "$WS_NAME" ]] || fail "usage: devbox-ws-ssh <workspace-name>"

source "$ROOT/scripts/lib/ws-meta.sh"
ws_load_meta "$WS_NAME"

# Workspace SSH user (by design: UID 1000 on Ubuntu 24.04)
SSH_USER="ubuntu"

echo "[devbox] ssh into ws-$WS_NAME as $SSH_USER on 127.0.0.1:$SSH_PORT"
exec ssh -p "$SSH_PORT" "$SSH_USER@127.0.0.1"
